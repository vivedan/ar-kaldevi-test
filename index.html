<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.0/dist/mindar-image-aframe.prod.js"></script>
    <!--<script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>-->
    
    
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    
    <script src="measurement.js"></script>
    <script src="shadow-material.js"></script>
    <script src="update-materials.js"></script>
    
    
    <a-scene mindar-image="imageTargetSrc: https://cdn.glitch.global/d53aff98-3990-4126-83f2-4ac2eb8d01da/targets.mind?v=1674941868358;  
                           filterMinCF: 1;
                           filterBeta: 0.001;" 
             color-space="sRGB" 
             renderer="colorManagement: true, physicallyCorrectLights" 
             vr-mode-ui="enabled: false" 
             device-orientation-permission-ui="enabled: false" 
             shadow="type: pcfsoft">
      <a-assets>
        <img id="card" src="https://cdn.glitch.global/d53aff98-3990-4126-83f2-4ac2eb8d01da/Tracker%20Silla.png?v=1674941824262" crossorigin="anonymous"/>
        <a-asset-item id="sorollaAsset" src="https://cdn.glitch.global/940e20c3-a1e1-440f-bc42-e14ab5ef4b62/Kaldevi_Sorolla_AR2.glb?v=1674927270635" crossorigin="anonymous"></a-asset-item>
      </a-assets>
      
      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
      
      <a-entity mindar-image-target="targetIndex: 0">
        <a-plane id="tracker" src="#card" position="0 0 0" width="1" height="0.645" rotation="0 0 0"></a-plane>
        <a-entity position="0 0 0.6" rotation="90 0 0">
          <a-gltf-model id="sorolla" position="0 0 0" src="#sorollaAsset" shadow="cast: true" measurement update-materials></a-gltf-model>

          <a-light color="white" position="0 3 0" light="castShadow: true; shadowMapHeight: 1024; shadowMapWidth: 1024;"></a-light>
          <a-light type="point" color="white" position="0 5 0"></a-light>
          <a-light type="point" color="white" position="-5 0 0"></a-light>
          <a-light type="point" color="white" position="5 0 0"></a-light>
          <a-light type="point" color="white" position="0 0 -5"></a-light>
          <a-light type="ambient" color="white"></a-light>
          <a-entity id="plane" position="0 -0.5 0" geometry="primitive:plane; width: 2; height: 2" rotation="-90 0 0" shadow="receive: true;" shadow-material></a-entity>
        </a-entity>
      </a-entity>
      
      
    </a-scene>
    
    <div id="buttonBand">
      <div id="infoButton" class="button" style="background: red;"></div>
      <div id="linkButton" class="button" style="background: white;"></div>
      <div id="materialButton" class="button" style="background: blue;"></div>
      <div id="scaleButton" class="button" style="background: yellow;"></div>
    </div>
    
    
    <script>
    
      let materialButton = document.getElementById('materialButton');
      let infoButton = document.getElementById('infoButton');
      let linkButton = document.getElementById('linkButton');
      let scaleButton = document.getElementById('scaleButton');
      
      let gltf = document.getElementById('sorolla');
      materialButton.addEventListener('click', ()=>{
        gltf.emit('toggleMaterial')
      });
      infoButton.addEventListener('click', ()=>{
        gltf.emit('toggleInfo');
      })
      linkButton.addEventListener('click', ()=>{
        window.open('https://ortopedia.kaldevi.com/producto/silla-de-ruedas-electrica-sorolla/', '_blank');
      })
      
    </script>
  </body>
</html>